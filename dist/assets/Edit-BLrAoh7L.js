import{r as x,u as L,m as R,j as e}from"./index-n5lagw8Y.js";import{I as w}from"./iconify-VfOFnMl8.js";import{I as U,a as V}from"./index-Cew-Mpd-.js";import{L as j}from"./Label-fniU0OUx.js";import{T as c}from"./TextInput-BqV0c51w.js";import{S as G}from"./Select-Dhx4EgIQ.js";import{T as z,a as _,b as n,c as q,d as J,e as d}from"./TableRow-DNxHhbic.js";import{T as k}from"./Tooltip-CDCKvG7n.js";import{B as v}from"./Button-BChG-RMT.js";import{A as K}from"./Alert-gpJFEXQ7.js";import{i as Q,f as W}from"./format-Ci4P0HhW.js";import{C as X}from"./CardBox-DP5V6wyZ.js";import{B as Y}from"./BreadcrumbComp-BUvza-Rs.js";import"./globalFetcher-ChilYVpY.js";import"./index-DAr7p5OD.js";import"./resolve-theme-BrLp9Ogr.js";import"./floating-ui.react-DP-UpT2K.js";import"./use-floating-DQGwidr_.js";import"./x-icon-6miUmzgF.js";import"./en-US-Bi_cwWVL.js";import"./toDate-qY-Vit60.js";import"./chevron-right-icon-BGQVsHY5.js";const Z=()=>{const{invoices:o,updateInvoice:E}=x.useContext(U),[F,T]=x.useState(!1),[C,f]=x.useState(null),[A,m]=x.useState(!1),[l,i]=x.useState(null),I=L().pathname;console.log(I);let h=I.split("/").pop();h&&(h=decodeURIComponent(h));const S=R();x.useEffect(()=>{if(o.length>0)if(h){const s=o.find(a=>a.billFrom===h);s?(f(s),i({...s}),m(!0)):(f(o[0]),i({...o[0]}),m(!0))}else f(o[0]),i({...o[0]}),m(!0)},[h,o]);const D=async()=>{try{await E(l),f({...l}),m(!1),T(!0),S("/apps/invoice/list")}catch(s){console.error("Error updating invoice:",s)}setTimeout(()=>{T(!1)},5e3)},P=()=>{m(!1)},b=(s,a,t)=>{const r=[...l.orders];r[s][a]=t,(a==="unitPrice"||a==="units")&&(r[s].unitTotalPrice=r[s].unitPrice*r[s].units);const N={...l,orders:r,totalCost:p(r),vat:u(r),grandTotal:g(p(r),u(r))};i(N)},B=()=>{const s={itemName:"",unitPrice:0,units:0,unitTotalPrice:0,vat:0},a=[...l.orders,s],t={...l,orders:a,totalCost:p(a),vat:u(a),grandTotal:g(p(a),u(a))};i(t)},O=s=>{const a=l.orders.filter((r,N)=>N!==s),t={...l,orders:a,totalCost:p(a),vat:u(a),grandTotal:g(p(a),u(a))};i(t)},p=s=>s.reduce((a,t)=>a+t.unitTotalPrice,0),u=s=>s.reduce((a,t)=>a+t.units,0),g=(s,a)=>s+=s*a/100;if(!C)return e.jsx("div",{children:"please select invoice"});const y=C.orderDate,M=Q(new Date(y))?new Date(y):new Date,H=W(M,"EEEE, MMMM dd, yyyy");return e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl mb-2",children:"Edit Invoice Details"}),e.jsxs("p",{children:["ID: ",l.id]}),e.jsxs("p",{children:["Date: ",H]}),e.jsx("div",{className:"bg-lightgray dark:bg-gray-800/70 p-6 my-6 rounded-md",children:e.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[e.jsxs("div",{className:"lg:col-span-4 md:col-span-6 col-span-12",children:[e.jsx("div",{className:"mb-2 block",children:e.jsx(j,{htmlFor:"billFrom",children:"Bill From"})}),e.jsx(c,{id:"billFrom",name:"billFrom",value:l.billFrom,onChange:s=>i({...l,billFrom:s.target.value}),className:"form-control"})]}),e.jsxs("div",{className:"lg:col-span-4 md:col-span-6 col-span-12",children:[e.jsx("div",{className:"mb-2 block",children:e.jsx(j,{htmlFor:"billto",children:"Bill To"})}),e.jsx(c,{id:"billto",name:"billto",value:l.billTo,onChange:s=>i({...l,billTo:s.target.value}),className:"form-control"})]}),e.jsxs("div",{className:"lg:col-span-4 md:col-span-6 col-span-12",children:[e.jsx("div",{className:"mb-2 block",children:e.jsx(j,{htmlFor:"status",children:"Status"})}),e.jsxs(G,{className:"select-md",value:l.status,onChange:s=>i({...l,status:s.target.value}),children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"delivered",children:"Delivered"}),e.jsx("option",{value:"Shipped",children:"Shipped"})]})]}),e.jsxs("div",{className:" md:col-span-6 col-span-12",children:[e.jsx("div",{className:"mb-2 block",children:e.jsx(j,{htmlFor:"fromadd",children:"From Address"})}),e.jsx(c,{id:"fromadd",name:"fromadd",value:l.billFromAddress,onChange:s=>i({...l,billFromAddress:s.target.value}),className:"form-control"})]}),e.jsxs("div",{className:" md:col-span-6 col-span-12",children:[e.jsx("div",{className:"mb-2 block",children:e.jsx(j,{htmlFor:"billtoadd",children:"Bill To Address"})}),e.jsx(c,{id:"billtoadd",name:"billtoadd",value:l.billToAddress,onChange:s=>i({...l,billToAddress:s.target.value}),className:"form-control"})]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(z,{children:[e.jsxs(_,{children:[e.jsx(n,{}),e.jsx(n,{children:"Item Name"}),e.jsx(n,{children:"Unit Price"}),e.jsx(n,{children:"Units"}),e.jsx(n,{children:"Total Cost"}),e.jsx(n,{}),e.jsx(n,{children:"Actions"})]}),e.jsx(q,{className:"divide-y divide-border dark:divide-darkborder ",children:l.orders.map((s,a)=>e.jsxs(J,{className:"",children:[e.jsx(d,{className:"whitespace-nowrap",children:e.jsx(k,{content:"Add Item",placement:"bottom",children:e.jsx(v,{className:"p-0 mb-2 bg-lightprimary text-primary h-8 w-8 rounded-full flex justify-center items-center  hover:bg-primary hover:text-white",onClick:B,children:e.jsx(w,{icon:"mdi:plus-circle",height:18})})})}),e.jsx(d,{className:"whitespace-nowrap min-w-44",children:e.jsx(c,{type:"text",value:s.itemName,onChange:t=>b(a,"itemName",t.target.value),className:"form-control"})}),e.jsx(d,{className:"whitespace-nowrap min-w-44",children:e.jsx(c,{type:"number",value:s.unitPrice,onChange:t=>b(a,"unitPrice",parseFloat(t.target.value)),className:"form-control"})}),e.jsx(d,{className:"whitespace-nowrap min-w-44",children:e.jsx(c,{type:"number",value:s.units,onChange:t=>b(a,"units",parseInt(t.target.value)),className:"form-control"})}),e.jsx(d,{className:"whitespace-nowrap min-w-32",children:s.unitTotalPrice}),e.jsx(d,{className:"whitespace-nowrap",children:" "}),e.jsx(d,{className:"whitespace-nowrap",children:e.jsx(k,{content:"Delete Invoice",placement:"bottom",children:e.jsx(v,{color:"lighterror",className:"btn-circle p-0 mb-2 dark:text-error group/link",onClick:()=>O(a),children:e.jsx(w,{icon:"solar:trash-bin-minimalistic-outline",className:"group-hover/link:text-white",height:18})})})})]},a))})]})}),e.jsxs("div",{className:"border-t border-ld  py-5 px-4 ",children:[e.jsx("div",{className:"flex justify-end mb-3",children:e.jsxs("div",{className:"flex gap-3 lg:w-1/5",children:[e.jsx("h2",{className:"max-w-52 w-full opacity-80",children:"Sub Total:"}),e.jsx("h3",{className:"ms-auto text-base",children:l.totalCost})]})}),e.jsx("div",{className:"flex justify-end mb-3",children:e.jsxs("div",{className:"flex gap-3 lg:w-1/5",children:[e.jsx("h2",{className:"max-w-52 w-full opacity-80",children:"Vat:"}),e.jsx("h3",{className:"ms-auto text-base",children:l.vat})]})}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("div",{className:"flex gap-3 lg:w-1/5",children:[e.jsx("h2",{className:"max-w-52 w-full opacity-80",children:"Grand Total:"}),e.jsx("h3",{className:"ms-auto text-base",children:l.grandTotal})]})})]}),e.jsx("div",{className:"flex justify-end gap-3 mt-2",children:A?e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(v,{color:"success",onClick:D,children:"Save"}),e.jsx(v,{color:"error",onClick:P,children:"Cancel"})]}):e.jsx(v,{color:"info",onClick:()=>m(!0),children:"Edit Invoice"})}),F&&e.jsx(K,{color:"success",rounded:!0,className:"fixed mx-auto start-0 end-0 top-3 w-fit z-9999",icon:()=>e.jsx(w,{icon:"solar:archive-minimalistic-broken",className:"text-white",height:22}),children:e.jsx("span",{className:"ms-2",children:"Invoice data updated successfully."})})]})},$=[{to:"/",title:"Home"},{title:"Invoice Edit"}],Te=()=>e.jsxs(V,{children:[e.jsx(Y,{title:"Invoice Edit",items:$}),e.jsx(X,{children:e.jsx(Z,{})})]});export{Te as default};
