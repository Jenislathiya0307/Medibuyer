import{r as i,j as e,R as z}from"./index-n5lagw8Y.js";import{a as I}from"./index-B3jNiIug.js";import{I as m}from"./iconify-VfOFnMl8.js";import{l as v}from"./lodash-zTfrBOso.js";import{S as E}from"./index-DIAcSD30.js";import{u as H,g as P,a as V}from"./globalFetcher-ChilYVpY.js";import{u as K}from"./user-1-Dc8z7YXL.js";import{B as h}from"./Badge-zDQe1ecK.js";import{D as F}from"./Dropdown-BiHFbrRM.js";import{D as b}from"./DropdownItem-DNuOlWcX.js";import{D as A}from"./DropdownDivider-CFCZAxIU.js";import{T as R}from"./TextInput-BqV0c51w.js";import{f as M}from"./formatDistanceToNowStrict-CuRN7-9l.js";import{B as U}from"./Button-BChG-RMT.js";import{H as L}from"./HR-By-0zIu6.js";import{D as O}from"./Drawer-7041U4gn.js";import{C as W}from"./CardBox-DP5V6wyZ.js";import{B as Y}from"./BreadcrumbComp-BUvza-Rs.js";import"./iconBase-CU_7cgqW.js";import"./index-DAr7p5OD.js";import"./resolve-theme-BrLp9Ogr.js";import"./floating-ui.react-DP-UpT2K.js";import"./use-floating-DQGwidr_.js";import"./chevron-down-icon-enmfNaQ_.js";import"./chevron-left-icon-CnsRMBS9.js";import"./chevron-right-icon-BGQVsHY5.js";import"./toDate-qY-Vit60.js";import"./en-US-Bi_cwWVL.js";import"./theme-CSbUk4Ig.js";const N=i.createContext({chatData:[],chatContent:[],chatSearch:"",selectedChat:null,loading:!0,error:"",activeChatId:null,setChatContent:()=>{},setChatSearch:()=>{},setSelectedChat:()=>{},setActiveChatId:()=>{},sendMessage:()=>{},setLoading:()=>{},setError:()=>{}}),G=({children:n})=>{const[t,l]=i.useState([]),[r,c]=i.useState([]),[d,o]=i.useState(""),[g,a]=i.useState(null),[w,C]=i.useState(1),[y,s]=i.useState(!0),[x,p]=i.useState(""),{data:j,isLoading:u,error:S,mutate:$}=H("/api/data/chat/ChatData",P);i.useEffect(()=>{if(j){s(u);const f=j.data;if(t.length===0){let k=f[0];a(k)}l(f)}else S?(p(S),s(u),console.log("Failed to fetch the data")):s(u)},[j,S,u,t.length]);const T={chatData:t,chatContent:r,chatSearch:d,selectedChat:g,loading:y,error:x,activeChatId:w,setChatContent:c,setChatSearch:o,setSelectedChat:a,setActiveChatId:C,sendMessage:async(f,k)=>{try{let{data:D}=await $(V("/api/sendMessage",{chatId:f,message:k})),_=D.find(q=>q.id===f);a(_)}catch(D){console.error("Error sending message:",D)}},setError:p,setLoading:s};return e.jsx(N.Provider,{value:T,children:n})},J=()=>{const n=[{icon:"solar:settings-outline",listtitle:"Setting",divider:!0},{icon:"solar:question-circle-outline",listtitle:"Helpand feedback",divider:!1},{icon:"solar:align-horizonta-spacing-line-duotone",listtitle:"Enable split View mode",divider:!1},{icon:"solar:keyboard-outline",listtitle:"Keyboard shortcut",divider:!0},{icon:"solar:logout-2-outline",listtitle:"Sign Out",divider:!1}],t=s=>v.last(s.messages)?.createdAt,l=s=>{let x="";const p=s.messages[s.messages.length-1];if(p){const j=p.senderId===s.id?"You: ":"",u=p.type==="image"?"Sent a photo":p.msg;x=`${j}${u}`}return x},{chatData:r,chatSearch:c,setChatSearch:d,setSelectedChat:o,setActiveChatId:g,activeChatId:a}=i.useContext(N),w=s=>{d(s.target.value)},C=r.filter(s=>s.name.toLowerCase().includes(c.toLowerCase())),y=s=>{const x=typeof s.id=="string"?parseInt(s.id,10):s.id;o(s),g(x)};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"left-part  w-full px-0 ",children:[e.jsxs("div",{className:"flex justify-between items-center px-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:K,height:56,width:56,alt:"user",className:"rounded-full"}),e.jsx(h,{color:"success",className:"p-0 h-2 w-2 absolute bottom-1 end-0"})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm mb-1",children:"Mike Nielsen"}),e.jsx("p",{className:"text-darklink dark:text-bodytext text-xs",children:"Marketing Director"})]})]}),e.jsx(F,{label:"",dismissOnClick:!1,renderTrigger:()=>e.jsx("span",{className:"h-9 w-9 flex justify-center items-center rounded-full hover:bg-lightprimary hover:text-primary cursor-pointer ",children:e.jsx(I,{size:22})}),children:n.map((s,x)=>e.jsxs(z.Fragment,{children:[e.jsxs(b,{className:"flex gap-3",children:[e.jsx(m,{icon:`${s.icon}`,height:18}),e.jsx("span",{children:s.listtitle})]}),s.divider==!0?e.jsx(A,{}):null]},x))})]}),e.jsxs("div",{className:"px-6",children:[e.jsx("div",{className:"flex gap-3 bg-white dark:bg-transparent  py-5 items-center ",children:e.jsx(R,{id:"search",placeholder:"Search contacts",onChange:w,value:c,className:"form-control w-full",sizing:"md",required:!0,icon:()=>e.jsx(m,{icon:"solar:magnifer-line-duotone",height:18})})}),e.jsx("div",{className:"mb-3",children:e.jsxs(F,{label:"Recent Chats",className:"bg-white text-ld px-0 dark:bg-dark hover:bg-transparent dark:hover:bg-transparent",children:[e.jsx(b,{className:"py-1 px-2",children:"Sort by Time"}),e.jsx(b,{className:"py-1 px-2",children:"Sort by Unread"}),e.jsx(A,{}),e.jsx(b,{className:"py-1 px-2",children:"Sort by Favourites"})]})})]}),e.jsx(E,{className:"max-h-[600px] h-[calc(100vh_-_100px)]",children:C.map(s=>e.jsxs("div",{className:`cursor-pointer py-4 px-6 gap-0 flex justify-between group bg-hover ${a===s.id?"bg-lightinfo/30":"initial"}`,onClick:()=>y(s),children:[e.jsxs("div",{className:"flex items-center gap-3 max-w-[235px] w-full",children:[e.jsxs("div",{className:"relative min-w-12",children:[e.jsx("img",{src:s.thumb,height:48,width:48,alt:"user",className:"rounded-full"}),s.status=="online"?e.jsx(h,{color:"success",className:"p-0 h-2 w-2 absolute bottom-1 end-0"}):s.status=="busy"?e.jsx(h,{color:"error",className:"p-0 h-2 w-2 absolute bottom-1 end-0"}):s.status=="away"?e.jsx(h,{color:"warning",className:"p-0 h-2 w-2 absolute bottom-1 end-0"}):e.jsx(h,{color:"primary",className:"p-0 h-2 w-2 absolute bottom-1 end-0"})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm mb-1",children:s.name}),e.jsx("div",{className:"text-sm text-ld opacity-90 line-clamp-1",children:l(s)})]})]}),e.jsx("div",{className:"text-xs pt-1",children:M(new Date(t(s)),{addSuffix:!1})})]},s.id))})]})})},B=()=>{const{selectedChat:n}=i.useContext(N),t=v.uniq(v.flatten(n?.messages.map(r=>r.attachment))).length,l=v.uniq(v.flatten(n?.messages.map(r=>r?.type==="image"?r.msg:null))).length-1;return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"p-5",children:[e.jsxs("h6",{className:"text-sm",children:[" Media (",l,")"]}),e.jsx("div",{className:"mt-3",children:e.jsx(e.Fragment,{children:e.jsx(z.Fragment,{children:n?.messages.map((r,c)=>e.jsx("div",{className:"md:col-span-4 sm:col-span-6 col-span-12",children:r?.type==="image"?e.jsx("img",{src:r.msg,alt:"media",className:"rounded-md",height:100,width:100}):null},c))})})}),e.jsxs("div",{className:"mt-8",children:[e.jsxs("h6",{className:"text-sm",children:["  Attachments (",t,")"]}),e.jsx("div",{children:n?.messages.map((r,c)=>e.jsx("div",{children:e.jsx("div",{className:"flex flex-col gap-4 mt-4",children:r?.attachment?.map((d,o)=>e.jsx("div",{children:e.jsxs("div",{className:"flex items-center gap-3 group cursor-pointer",children:[e.jsx("div",{className:"bg-muted dark:bg-darkmuted p-3 rounded-md",children:e.jsx("img",{src:d.icon||"",height:24,width:24,alt:"download"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm group-hover:text-primary",children:d.file}),e.jsx("p",{className:"text-xs text-darklink dark:text-bodytext",children:d.fileSize})]}),e.jsx("div",{className:"btn-circle-hover cursor-pointer invisible  group-hover:visible ms-auto  opacity:50",children:e.jsx(m,{icon:"solar:download-outline",height:"20"})})]})},o))})},c))})]})]})})},Q=({onClickMobile:n})=>{const{selectedChat:t}=i.useContext(N),[l,r]=i.useState(!0),c=()=>{r(!l)},[d,o]=i.useState(!1),g=()=>o(!1);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-5",children:e.jsx("div",{children:t?e.jsxs("div",{className:"flex items-center justify-between lg:flex-nowrap flex-wrap lg:gap-0 gap-2",children:[e.jsxs("div",{className:"flex items-center gap-3 ",children:[e.jsx(U,{color:"lightprimary",className:"btn-circle p-0 lg:hidden flex",onClick:n,children:e.jsx(m,{icon:"solar:hamburger-menu-outline",height:18})}),e.jsxs("div",{className:"relative sm:min-w-12 min-w-9",children:[e.jsx("img",{src:t.thumb,height:48,width:48,alt:"user",className:"rounded-full sm:h-12 sm:w-12 h-9 w-9"}),t.status=="online"?e.jsx(h,{color:"success",className:"p-0 h-2 w-2 absolute bottom-1 end-0"}):t.status=="busy"?e.jsx(h,{color:"error",className:"p-0 h-2 w-2 absolute bottom-1 end-0"}):t.status=="away"?e.jsx(h,{color:"warning",className:"p-0 h-2 w-2 absolute bottom-1 end-0"}):e.jsx(h,{color:"primary",className:"p-0 h-2 w-2 absolute bottom-1 end-0"})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-base sm:mb-1",children:t.name}),e.jsx("div",{className:"text-sm text-ld opacity-90 line-clamp-1",children:t.status})]})]}),e.jsxs("div",{className:"flex items-center md:gap-2 gap-1",children:[e.jsx("div",{className:"btn-circle-hover cursor-pointer sm:h-10 sm:w-10",children:e.jsx(m,{icon:"solar:phone-rounded-linear",height:25,className:"sm:h-10 h-5 "})}),e.jsx("div",{className:"btn-circle-hover cursor-pointer sm:h-10 sm:w-10",children:e.jsx(m,{icon:"solar:videocamera-outline",height:25,className:"sm:h-10 h-5 "})}),e.jsx("div",{className:"btn-circle-hover cursor-pointer sm:h-10 sm:w-10 xl:flex hidden",onClick:c,children:e.jsx(I,{size:18,className:"sm:h-10 h-5 "})}),e.jsx("div",{className:"btn-circle-hover cursor-pointer sm:h-10 sm:w-10 xl:hidden flex",onClick:()=>o(!0),children:e.jsx(I,{size:20,className:"sm:h-10 h-5 "})})]})]}):null})}),e.jsx(L,{className:"my-0"}),e.jsxs("div",{className:"flex max-h-[800px] h-[650px] ",children:[e.jsx("div",{className:`transition-all ${l?"xl:w-[calc(100%_-_300px)] w-full":"lg:w-[calc(100%_-_0px)]"} `,children:e.jsx("div",{className:`${l?"lg:border-e":"border-none"} border-ld h-full py-5 px-5`,children:e.jsx(E,{className:"max-h-[700px] h-[600px]",children:e.jsx("div",{children:e.jsx(e.Fragment,{children:t?.messages?.map(a=>e.jsx("div",{className:"flex gap-3 mb-[30px]",children:t.id===a.senderId?e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-10",children:e.jsx("img",{src:t.thumb,height:40,width:40,alt:"user",className:"rounded-full"})}),a.type==="text"?e.jsxs("div",{children:[e.jsxs("div",{className:"text-xs text-ld opacity-60 font-medium mb-1 block",children:[t.name,","," ",M(new Date(a.createdAt),{addSuffix:!1})," ","ago"]}),e.jsx("div",{className:"p-2 bg-muted dark:bg-darkmuted text-ld rounded-md",children:a.msg})]}):null,a.type==="image"?e.jsx("img",{src:a.msg,height:150,width:150,alt:"user",className:"rounded-md"}):null]}):e.jsx("div",{className:"flex  justify-end w-full",children:e.jsxs("div",{children:[a.createdAt?e.jsxs("div",{className:"text-xs text-ld opacity-60 font-medium mb-1 block text-end",children:[M(new Date(a.createdAt),{addSuffix:!1})," ","ago"]}):null,a.type==="text"?e.jsx("div",{className:"p-2 bg-lightinfo text-ld dark:bg-lightinfo rounded-md",children:a.msg}):null,a.type==="image"?e.jsx("img",{src:a.msg,height:150,width:150,alt:"user",className:"rounded-md"}):null]})})},a.id+a.createdAt))})})})})}),l&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`shrink-0 ${l?"xl:max-w-[300px] max-w-0":"max-w-0"}`,children:e.jsx(B,{})}),e.jsx(O,{open:d,onClose:g,className:"max-w-[300px] ",position:"right",children:e.jsx("div",{children:e.jsx(B,{})})})]})]})]})},X=()=>{const{sendMessage:n,selectedChat:t}=i.useContext(N),[l,r]=i.useState(""),c=o=>{r(o.target.value)},d=o=>{o.preventDefault(),!(!l.trim()||!t)&&(n(t.id,l.trim()),r(""))};return e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:d,children:e.jsxs("div",{className:"flex lg:gap-3 gap-0.5 items-center py-5 px-5 lg:flex-nowrap flex-wrap",children:[e.jsxs("div",{className:"flex item-center flex-1",children:[e.jsx("div",{className:"btn-circle-hover cursor-pointer",children:e.jsx(m,{icon:"solar:sticker-smile-circle-2-linear",height:"20"})}),e.jsx(R,{className:"form-control-chat border-0 w-full min-w-10",sizing:"md",required:!0,value:l,onChange:c})]}),e.jsxs("div",{className:"flex gap-3 items-center",children:[e.jsx("div",{className:"btn-circle-hover cursor-pointer ",children:e.jsx(m,{icon:"solar:plain-linear",height:"20",onClick:()=>{n(t?.id||"",l),r("")}})}),e.jsx("div",{className:"btn-circle-hover cursor-pointer",children:e.jsx(m,{icon:"solar:gallery-add-linear",height:"20"})}),e.jsx("div",{className:"btn-circle-hover cursor-pointer",children:e.jsx(m,{icon:"solar:paperclip-outline",height:"20"})}),e.jsx("div",{className:"btn-circle-hover cursor-pointer",children:e.jsx(m,{icon:"solar:microphone-2-outline",height:"20"})})]})]})})})},Z=()=>{const[n,t]=i.useState(!1),l=()=>t(!1);return e.jsx(e.Fragment,{children:e.jsx(G,{children:e.jsx(W,{className:"p-0 overflow-hidden",children:e.jsxs("div",{className:"flex",children:[e.jsx(O,{open:n,onClose:l,className:"lg:relative lg:translate-none lg:h-auto dark:bg-dark lg:bg-transparent max-w-[350px] w-full  lg:z-0 ",children:e.jsx(J,{})}),e.jsxs("div",{className:"grow w-[70%]",children:[e.jsx(Q,{onClickMobile:()=>t(!0)}),e.jsx(L,{className:"my-0"}),e.jsx(X,{})]})]})})})})},ee=[{to:"/",title:"Home"},{title:"Chat"}],Ae=()=>e.jsxs(e.Fragment,{children:[e.jsx(Y,{title:"Chat App",items:ee}),e.jsx(Z,{})]});export{Ae as default};
