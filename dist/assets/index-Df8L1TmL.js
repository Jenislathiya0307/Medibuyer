import{r,j as se}from"./index-n5lagw8Y.js";import{u as v,g as F,a as ce,d as ae,p as N}from"./globalFetcher-ChilYVpY.js";const oe=r.createContext({}),de=({children:B})=>{const[o,n]=r.useState([]),[x,D]=r.useState(""),[m,p]=r.useState("All"),[L,g]=r.useState("newest"),[a,S]=r.useState("All"),[f,C]=r.useState("All"),[y,P]=r.useState("All"),[G,c]=r.useState(!0),[j,R]=r.useState(null),[i,h]=r.useState(()=>{if(typeof window<"u"){const e=localStorage.getItem("cartItems");return e?JSON.parse(e):[]}else return[]}),{data:w,isLoading:d,error:A}=v("/api/data/eCommerce/ProductsData",F);r.useEffect(()=>{w?(n(w.data),c(d)):(A&&R(A),c(d))},[w,A,d]);const{data:I,isLoading:l,error:E,mutate:u}=v("/api/eCommerce/carts",F);r.useEffect(()=>{I?(h(I.data),c(l)):(E&&R(E),c(l))},[I,E,l]),r.useEffect(()=>{i&&localStorage.setItem("cartItems",JSON.stringify(i))},[i]),r.useEffect(()=>{const e=localStorage.getItem("cartItems");e&&h(JSON.parse(e))},[]);const J=e=>{const t=e.title.toLowerCase().includes(x.toLowerCase()),s=m==="All"||e.category.includes(m),ee=a==="All"||a==="0-50"&&e.price<=50||a==="50-100"&&e.price>50&&e.price<=100||a==="100-200"&&e.price>100&&e.price<=200||a==="200-99999"&&e.price>200,te=f==="All"||e.gender===f,re=y==="All"||e.colors.includes(y);return t&&s&&ee&&te&&re},O=e=>{switch(L){case"newest":return e.sort((t,s)=>new Date(s.created).getTime()-new Date(t.created).getTime());case"priceDesc":return e.sort((t,s)=>s.price-t.price);case"priceAsc":return e.sort((t,s)=>t.price-s.price);case"discount":return e.sort((t,s)=>(s.discount||0)-(t.discount||0));default:return e}},T=e=>o.find(s=>s.id===Number(e)),b=o.filter(J),q=O(b),Q=e=>p(e),M=e=>g(e),W=e=>S(e),k=e=>C(e),z=e=>P(e),H=e=>D(e),K=async e=>{try{await u(ce("/api/data/eCommerce/add",{productId:e}))}catch(t){console.error("Error adding product to cart:",t)}},U=async e=>{await u(ae("/api/eCommerce/remove-item-carts",{id:e,action:"Increment"}))},V=async e=>{await u(N("/api/eCommerce/carts/increment-decrementqty",{id:e,action:"Increment"}))},X=async e=>{await u(N("/api/eCommerce/carts/increment-decrementqty",{id:e,action:"Decrement"}))},Y=e=>{n(o.filter(t=>t.id!==e))},Z=()=>{n([])},_=(e,t)=>{n(o.map(s=>s.id===Number(e)?t:s))},$=()=>{p("All"),P("All"),C("All"),S("All"),g("newest")};return se.jsx(oe.Provider,{value:{products:o,searchProduct:x,selectedCategory:m,sortBy:L,priceRange:a,selectedGender:f,selectedColor:y,loading:G,error:j,cartItems:i,setProducts:n,setSearchProduct:D,setSelectedCategory:p,setSortBy:g,setPriceRange:S,setSelectedGender:C,setSelectedColor:P,setLoading:c,setCartItems:h,deleteProduct:Y,searchProducts:H,updateSortBy:M,updatePriceRange:W,selectCategory:Q,selectGender:k,selectColor:z,incrementQuantity:V,decrementQuantity:X,removeFromCart:U,addToCart:K,deleteAllProducts:Z,filteredAndSortedProducts:q,filterReset:$,getProductById:T,updateProduct:_},children:B})};export{oe as P,de as a};
