import{r as O,R as vt}from"./index-n5lagw8Y.js";import{s as Zt}from"./index-DAr7p5OD.js";const qt=0,kt=1,Ht=2,jt=3;var Pt=Object.prototype.hasOwnProperty;function Et(t,e){var n,s;if(t===e)return!0;if(t&&e&&(n=t.constructor)===e.constructor){if(n===Date)return t.getTime()===e.getTime();if(n===RegExp)return t.toString()===e.toString();if(n===Array){if((s=t.length)===e.length)for(;s--&&Et(t[s],e[s]););return s===-1}if(!n||typeof t=="object"){s=0;for(n in t)if(Pt.call(t,n)&&++s&&!Pt.call(e,n)||!(n in e)||!Et(t[n],e[n]))return!1;return Object.keys(e).length===s}}return t!==t&&e!==e}const x=new WeakMap,M=()=>{},v=M(),mt=Object,i=t=>t===v,N=t=>typeof t=="function",U=(t,e)=>({...t,...e}),Jt=t=>N(t.then),ut={},st={},Ct="undefined",Q=typeof window!=Ct,Rt=typeof document!=Ct,te=Q&&"Deno"in window,ee=()=>Q&&typeof window.requestAnimationFrame!=Ct,$t=(t,e)=>{const n=x.get(t);return[()=>!i(e)&&t.get(e)||ut,s=>{if(!i(e)){const c=t.get(e);e in st||(st[e]=c),n[5](e,U(c,s),c||ut)}},n[6],()=>!i(e)&&e in st?st[e]:!i(e)&&t.get(e)||ut]};let gt=!0;const ne=()=>gt,[wt,Ot]=Q&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[M,M],se=()=>{const t=Rt&&document.visibilityState;return i(t)||t!=="hidden"},oe=t=>(Rt&&document.addEventListener("visibilitychange",t),wt("focus",t),()=>{Rt&&document.removeEventListener("visibilitychange",t),Ot("focus",t)}),re=t=>{const e=()=>{gt=!0,t()},n=()=>{gt=!1};return wt("online",e),wt("offline",n),()=>{Ot("online",e),Ot("offline",n)}},ie={isOnline:ne,isVisible:se},ae={initFocus:oe,initReconnect:re},xt=!vt.useId,X=!Q||te,ce=t=>ee()?window.requestAnimationFrame(t):setTimeout(t,1),lt=X?O.useEffect:O.useLayoutEffect,ft=typeof navigator<"u"&&navigator.connection,Wt=!X&&ft&&(["slow-2g","2g"].includes(ft.effectiveType)||ft.saveData),ot=new WeakMap,ue=t=>mt.prototype.toString.call(t),dt=(t,e)=>t===`[object ${e}]`;let le=0;const Tt=t=>{const e=typeof t,n=ue(t),s=dt(n,"Date"),c=dt(n,"RegExp"),l=dt(n,"Object");let r,u;if(mt(t)===t&&!s&&!c){if(r=ot.get(t),r)return r;if(r=++le+"~",ot.set(t,r),Array.isArray(t)){for(r="@",u=0;u<t.length;u++)r+=Tt(t[u])+",";ot.set(t,r)}if(l){r="#";const p=mt.keys(t).sort();for(;!i(u=p.pop());)i(t[u])||(r+=u+":"+Tt(t[u])+",");ot.set(t,r)}}else r=s?t.toJSON():e=="symbol"?t.toString():e=="string"?JSON.stringify(t):""+t;return r},Dt=t=>{if(N(t))try{t=t()}catch{t=""}const e=t;return t=typeof t=="string"?t:(Array.isArray(t)?t.length:t)?Tt(t):"",[t,e]};let fe=0;const St=()=>++fe;async function Bt(...t){const[e,n,s,c]=t,l=U({populateCache:!0,throwOnError:!0},typeof c=="boolean"?{revalidate:c}:c||{});let r=l.populateCache;const u=l.rollbackOnError;let p=l.optimisticData;const b=C=>typeof u=="function"?u(C):u!==!1,T=l.throwOnError;if(N(n)){const C=n,E=[],I=e.keys();for(const m of I)!/^\$(inf|sub)\$/.test(m)&&C(e.get(m)._k)&&E.push(m);return Promise.all(E.map(g))}return g(n);async function g(C){const[E]=Dt(C);if(!E)return;const[I,m]=$t(e,E),[rt,o,Z,z]=x.get(e),W=()=>{const D=rt[E];return(N(l.revalidate)?l.revalidate(I().data,C):l.revalidate!==!1)&&(delete Z[E],delete z[E],D&&D[0])?D[0](Ht).then(()=>I().data):I().data};if(t.length<3)return W();let S=s,V,L=!1;const h=St();o[E]=[h,0];const H=!i(p),F=I(),J=F.data,tt=F._c,q=i(tt)?J:tt;if(H&&(p=N(p)?p(q,J):p,m({data:p,_c:q})),N(S))try{S=S(q)}catch(D){V=D,L=!0}if(S&&Jt(S))if(S=await S.catch(D=>{V=D,L=!0}),h!==o[E][0]){if(L)throw V;return S}else L&&H&&b(V)&&(r=!0,m({data:q,_c:v}));if(r&&!L)if(N(r)){const D=r(S,q);m({data:D,error:v,_c:v})}else m({data:S,error:v,_c:v});if(o[E][1]=St(),Promise.resolve(W()).then(()=>{m({_c:v})}),L){if(T)throw V;return}return S}}const Mt=(t,e)=>{for(const n in t)t[n][0]&&t[n][0](e)},de=(t,e)=>{if(!x.has(t)){const n=U(ae,e),s=Object.create(null),c=Bt.bind(v,t);let l=M;const r=Object.create(null),u=(T,g)=>{const C=r[T]||[];return r[T]=C,C.push(g),()=>C.splice(C.indexOf(g),1)},p=(T,g,C)=>{t.set(T,g);const E=r[T];if(E)for(const I of E)I(g,C)},b=()=>{if(!x.has(t)&&(x.set(t,[s,Object.create(null),Object.create(null),Object.create(null),c,p,u]),!X)){const T=n.initFocus(setTimeout.bind(v,Mt.bind(v,s,qt))),g=n.initReconnect(setTimeout.bind(v,Mt.bind(v,s,kt)));l=()=>{T&&T(),g&&g(),x.delete(t)}}};return b(),[t,c,b,l]}return[t,x.get(t)[4]]},he=(t,e,n,s,c)=>{const l=n.errorRetryCount,r=c.retryCount,u=~~((Math.random()+.5)*(1<<(r<8?r:8)))*n.errorRetryInterval;!i(l)&&r>l||setTimeout(s,u,c)},pe=Et,[Kt,Ee]=de(new Map),me=U({onLoadingSlow:M,onSuccess:M,onError:M,onErrorRetry:he,onDiscarded:M,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:Wt?1e4:5e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:Wt?5e3:3e3,compare:pe,isPaused:()=>!1,cache:Kt,mutate:Ee,fallback:{}},ie),Re=(t,e)=>{const n=U(t,e);if(e){const{use:s,fallback:c}=t,{use:l,fallback:r}=e;s&&l&&(n.use=s.concat(l)),c&&r&&(n.fallback=U(c,r))}return n},ge=O.createContext({}),we="$inf$",zt=Q&&window.__SWR_DEVTOOLS_USE__,Oe=zt?window.__SWR_DEVTOOLS_USE__:[],Te=()=>{zt&&(window.__SWR_DEVTOOLS_REACT__=vt)},Se=t=>N(t[1])?[t[0],t[1],t[2]||{}]:[t[0],null,(t[1]===null?t[2]:t[1])||{}],ve=()=>{const t=O.useContext(ge);return O.useMemo(()=>U(me,t),[t])},Ce=t=>(e,n,s)=>t(e,n&&((...l)=>{const[r]=Dt(e),[,,,u]=x.get(Kt);if(r.startsWith(we))return n(...l);const p=u[r];return i(p)?n(...l):(delete u[r],p)}),s),De=Oe.concat(Ce),ye=t=>function(...n){const s=ve(),[c,l,r]=Se(n),u=Re(s,r);let p=t;const{use:b}=u,T=(b||[]).concat(De);for(let g=T.length;g--;)p=T[g](p);return p(c,l||u.fetcher||null,u)},_e=(t,e,n)=>{const s=e[t]||(e[t]=[]);return s.push(n),()=>{const c=s.indexOf(n);c>=0&&(s[c]=s[s.length-1],s.pop())}};Te();const ht=vt.use||(t=>{switch(t.status){case"pending":throw t;case"fulfilled":return t.value;case"rejected":throw t.reason;default:throw t.status="pending",t.then(e=>{t.status="fulfilled",t.value=e},e=>{t.status="rejected",t.reason=e}),t}}),pt={dedupe:!0},Ut=Promise.resolve(v),be=(t,e,n)=>{const{cache:s,compare:c,suspense:l,fallbackData:r,revalidateOnMount:u,revalidateIfStale:p,refreshInterval:b,refreshWhenHidden:T,refreshWhenOffline:g,keepPreviousData:C}=n,[E,I,m,rt]=x.get(s),[o,Z]=Dt(t),z=O.useRef(!1),W=O.useRef(!1),S=O.useRef(o),V=O.useRef(e),L=O.useRef(n),h=()=>L.current,H=()=>h().isVisible()&&h().isOnline(),[F,J,tt,q]=$t(s,o),D=O.useRef({}).current,G=i(r)?i(n.fallback)?v:n.fallback[o]:r,yt=(a,d)=>{for(const R in D){const f=R;if(f==="data"){if(!c(a[f],d[f])&&(!i(a[f])||!c(nt,d[f])))return!1}else if(d[f]!==a[f])return!1}return!0},_t=O.useMemo(()=>{const a=!o||!e?!1:i(u)?h().isPaused()||l?!1:p!==!1:u,d=y=>{const j=U(y);return delete j._k,a?{isValidating:!0,isLoading:!0,...j}:j},R=F(),f=q(),A=d(R),K=R===f?A:d(f);let w=A;return[()=>{const y=d(F());return yt(y,w)?(w.data=y.data,w.isLoading=y.isLoading,w.isValidating=y.isValidating,w.error=y.error,w):(w=y,y)},()=>K]},[s,o]),$=Zt.useSyncExternalStore(O.useCallback(a=>tt(o,(d,R)=>{yt(R,d)||a()}),[s,o]),_t[0],_t[1]),bt=!z.current,Gt=E[o]&&E[o].length>0,B=$.data,k=i(B)?G&&Jt(G)?ht(G):G:B,et=$.error,it=O.useRef(k),nt=C?i(B)?i(it.current)?k:it.current:B:k,At=Gt&&!i(et)?!1:bt&&!i(u)?u:h().isPaused()?!1:l?i(k)?!1:p:i(k)||p,It=!!(o&&e&&bt&&At),Yt=i($.isValidating)?It:$.isValidating,Xt=i($.isLoading)?It:$.isLoading,Y=O.useCallback(async a=>{const d=V.current;if(!o||!d||W.current||h().isPaused())return!1;let R,f,A=!0;const K=a||{},w=!m[o]||!K.dedupe,y=()=>xt?!W.current&&o===S.current&&z.current:o===S.current,j={isValidating:!1,isLoading:!1},Ft=()=>{J(j)},Nt=()=>{const _=m[o];_&&_[1]===f&&delete m[o]},Vt={isValidating:!0};i(F().data)&&(Vt.isLoading=!0);try{if(w&&(J(Vt),n.loadingTimeout&&i(F().data)&&setTimeout(()=>{A&&y()&&h().onLoadingSlow(o,n)},n.loadingTimeout),m[o]=[d(Z),St()]),[R,f]=m[o],R=await R,w&&setTimeout(Nt,n.dedupingInterval),!m[o]||m[o][1]!==f)return w&&y()&&h().onDiscarded(o),!1;j.error=v;const _=I[o];if(!i(_)&&(f<=_[0]||f<=_[1]||_[1]===0))return Ft(),w&&y()&&h().onDiscarded(o),!1;const P=F().data;j.data=c(P,R)?P:R,w&&y()&&h().onSuccess(R,o,n)}catch(_){Nt();const P=h(),{shouldRetryOnError:at}=P;P.isPaused()||(j.error=_,w&&y()&&(P.onError(_,o,P),(at===!0||N(at)&&at(_))&&(!h().revalidateOnFocus||!h().revalidateOnReconnect||H())&&P.onErrorRetry(_,o,P,Qt=>{const ct=E[o];ct&&ct[0]&&ct[0](jt,Qt)},{retryCount:(K.retryCount||0)+1,dedupe:!0})))}return A=!1,Ft(),!0},[o,s]),Lt=O.useCallback((...a)=>Bt(s,S.current,...a),[]);if(lt(()=>{V.current=e,L.current=n,i(B)||(it.current=B)}),lt(()=>{if(!o)return;const a=Y.bind(v,pt);let d=0;h().revalidateOnFocus&&(d=Date.now()+h().focusThrottleInterval);const f=_e(o,E,(A,K={})=>{if(A==qt){const w=Date.now();h().revalidateOnFocus&&w>d&&H()&&(d=w+h().focusThrottleInterval,a())}else if(A==kt)h().revalidateOnReconnect&&H()&&a();else{if(A==Ht)return Y();if(A==jt)return Y(K)}});return W.current=!1,S.current=o,z.current=!0,J({_k:Z}),At&&(m[o]||(i(k)||X?a():ce(a))),()=>{W.current=!0,f()}},[o]),lt(()=>{let a;function d(){const f=N(b)?b(F().data):b;f&&a!==-1&&(a=setTimeout(R,f))}function R(){!F().error&&(T||h().isVisible())&&(g||h().isOnline())?Y(pt).then(d):d()}return d(),()=>{a&&(clearTimeout(a),a=-1)}},[b,T,g,o]),O.useDebugValue(nt),l){const a=o&&i(k);if(!xt&&X&&a)throw new Error("Fallback data is required when using Suspense in SSR.");a&&(V.current=e,L.current=n,W.current=!1);const d=rt[o],R=!i(d)&&a?Lt(d):Ut;if(ht(R),!i(et)&&a)throw et;const f=a?Y(pt):Ut;!i(nt)&&a&&(f.status="fulfilled",f.value=!0),ht(f)}return{mutate:Lt,get data(){return D.data=!0,nt},get error(){return D.error=!0,et},get isValidating(){return D.isValidating=!0,Yt},get isLoading(){return D.isLoading=!0,Xt}}},Fe=ye(be),Ne=t=>fetch(t).then(e=>{if(!e.ok)throw new Error("Failed to fetch the data");return e.json()}),Ve=(t,e)=>fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(n=>{if(!n.ok)throw new Error("Failed to post data");return n.json()}),je=(t,e)=>fetch(t,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(n=>{if(!n.ok)throw new Error("Failed to updated data");return n.json()}),Pe=(t,e)=>fetch(t,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(n=>{if(!n.ok)throw new Error("Failed to updated data");return n.json()}),xe=(t,e)=>fetch(t,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(n=>{if(!n.ok)throw new Error("Failed to delete data");return n.json()});export{Ve as a,Pe as b,xe as d,Ne as g,Ee as m,je as p,Fe as u};
